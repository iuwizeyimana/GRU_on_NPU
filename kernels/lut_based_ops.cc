//===---  lut_based_ops.cpp - lookup table based operations ---===//
//
// This file is licensed under the Apache License v2.0 with LLVM Exceptions
// See https://llvm.org/LICENSE.txt for license information.
// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
//
// (c) Copyright 2023 Xilinx Inc.
//
//
//===----------------------------------------------------------------------===//
// Lookup table based operations
//===----------------------------------------------------------------------===//

#include <aie_api/aie.hpp>

// The tables _ab and _cd are copies of each other
// Also, each table has a copy of data seperated by 128-bit
// This effectively creates 4 copies of the table (located in 4 (128-bit) banks)
// This allows the user to use the "gather" read feature and read 4 values from
// 4 different banks at once Tables entries are in BF16
//
// Tanh look up tables: Divides into 32 segments between [-4,4], bank size:
// (32*2*2*4)*2=1k, one lut=512B

float chess_storage(% chess_alignof(v32int8)) tanh_lut_ab[128] = {
    0.00000000000000000000000000000000, -1.00000000000000000000000000000000,
    0.00283813476562500000000000000000, -0.98828125000000000000000000000000,
    0.00000000000000000000000000000000, -1.00000000000000000000000000000000,
    0.00283813476562500000000000000000, -0.98828125000000000000000000000000,
    0.00509643554687500000000000000000, -0.98046875000000000000000000000000,
    0.00750732421875000000000000000000, -0.97265625000000000000000000000000,
    0.00509643554687500000000000000000, -0.98046875000000000000000000000000,
    0.00750732421875000000000000000000, -0.97265625000000000000000000000000,
    0.01269531250000000000000000000000, -0.95703125000000000000000000000000,
    0.02124023437500000000000000000000, -0.93359375000000000000000000000000,
    0.01269531250000000000000000000000, -0.95703125000000000000000000000000,
    0.02124023437500000000000000000000, -0.93359375000000000000000000000000,
    0.03540039062500000000000000000000, -0.89843750000000000000000000000000,
    0.05639648437500000000000000000000, -0.85156250000000000000000000000000,
    0.03540039062500000000000000000000, -0.89843750000000000000000000000000,
    0.05639648437500000000000000000000, -0.85156250000000000000000000000000,
    0.09179687500000000000000000000000, -0.78125000000000000000000000000000,
    0.14550781250000000000000000000000, -0.68750000000000000000000000000000,
    0.09179687500000000000000000000000, -0.78125000000000000000000000000000,
    0.14550781250000000000000000000000, -0.68750000000000000000000000000000,
    0.22949218750000000000000000000000, -0.56250000000000000000000000000000,
    0.34765625000000000000000000000000, -0.41601562500000000000000000000000,
    0.22949218750000000000000000000000, -0.56250000000000000000000000000000,
    0.34765625000000000000000000000000, -0.41601562500000000000000000000000,
    0.50390625000000000000000000000000, -0.25976562500000000000000000000000,
    0.69140625000000000000000000000000, -0.11962890625000000000000000000000,
    0.50390625000000000000000000000000, -0.25976562500000000000000000000000,
    0.69140625000000000000000000000000, -0.11962890625000000000000000000000,
    0.86718750000000000000000000000000, -0.03076171875000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    0.86718750000000000000000000000000, -0.03076171875000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    0.86718750000000000000000000000000, 0.03076171875000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    0.86718750000000000000000000000000, 0.03076171875000000000000000000000,
    0.69140625000000000000000000000000, 0.11962890625000000000000000000000,
    0.50390625000000000000000000000000, 0.25976562500000000000000000000000,
    0.69140625000000000000000000000000, 0.11962890625000000000000000000000,
    0.50390625000000000000000000000000, 0.25976562500000000000000000000000,
    0.34765625000000000000000000000000, 0.41601562500000000000000000000000,
    0.22949218750000000000000000000000, 0.56250000000000000000000000000000,
    0.34765625000000000000000000000000, 0.41601562500000000000000000000000,
    0.22949218750000000000000000000000, 0.56250000000000000000000000000000,
    0.14550781250000000000000000000000, 0.68750000000000000000000000000000,
    0.09179687500000000000000000000000, 0.78125000000000000000000000000000,
    0.14550781250000000000000000000000, 0.68750000000000000000000000000000,
    0.09179687500000000000000000000000, 0.78125000000000000000000000000000,
    0.05639648437500000000000000000000, 0.85156250000000000000000000000000,
    0.03540039062500000000000000000000, 0.89843750000000000000000000000000,
    0.05639648437500000000000000000000, 0.85156250000000000000000000000000,
    0.03540039062500000000000000000000, 0.89843750000000000000000000000000,
    0.02124023437500000000000000000000, 0.93359375000000000000000000000000,
    0.01269531250000000000000000000000, 0.95703125000000000000000000000000,
    0.02124023437500000000000000000000, 0.93359375000000000000000000000000,
    0.01269531250000000000000000000000, 0.95703125000000000000000000000000,
    0.00750732421875000000000000000000, 0.97265625000000000000000000000000,
    0.00509643554687500000000000000000, 0.98046875000000000000000000000000,
    0.00750732421875000000000000000000, 0.97265625000000000000000000000000,
    0.00509643554687500000000000000000, 0.98046875000000000000000000000000,
    0.00283813476562500000000000000000, 0.98828125000000000000000000000000,
    0.00000000000000000000000000000000, 1.00000000000000000000000000000000,
    0.00283813476562500000000000000000, 0.98828125000000000000000000000000,
    0.00000000000000000000000000000000, 1.00000000000000000000000000000000,
};

float chess_storage(% chess_alignof(v32int8)) tanh_lut_cd[128] = {
    0.00000000000000000000000000000000, -1.00000000000000000000000000000000,
    0.00283813476562500000000000000000, -0.98828125000000000000000000000000,
    0.00000000000000000000000000000000, -1.00000000000000000000000000000000,
    0.00283813476562500000000000000000, -0.98828125000000000000000000000000,
    0.00509643554687500000000000000000, -0.98046875000000000000000000000000,
    0.00750732421875000000000000000000, -0.97265625000000000000000000000000,
    0.00509643554687500000000000000000, -0.98046875000000000000000000000000,
    0.00750732421875000000000000000000, -0.97265625000000000000000000000000,
    0.01269531250000000000000000000000, -0.95703125000000000000000000000000,
    0.02124023437500000000000000000000, -0.93359375000000000000000000000000,
    0.01269531250000000000000000000000, -0.95703125000000000000000000000000,
    0.02124023437500000000000000000000, -0.93359375000000000000000000000000,
    0.03540039062500000000000000000000, -0.89843750000000000000000000000000,
    0.05639648437500000000000000000000, -0.85156250000000000000000000000000,
    0.03540039062500000000000000000000, -0.89843750000000000000000000000000,
    0.05639648437500000000000000000000, -0.85156250000000000000000000000000,
    0.09179687500000000000000000000000, -0.78125000000000000000000000000000,
    0.14550781250000000000000000000000, -0.68750000000000000000000000000000,
    0.09179687500000000000000000000000, -0.78125000000000000000000000000000,
    0.14550781250000000000000000000000, -0.68750000000000000000000000000000,
    0.22949218750000000000000000000000, -0.56250000000000000000000000000000,
    0.34765625000000000000000000000000, -0.41601562500000000000000000000000,
    0.22949218750000000000000000000000, -0.56250000000000000000000000000000,
    0.34765625000000000000000000000000, -0.41601562500000000000000000000000,
    0.50390625000000000000000000000000, -0.25976562500000000000000000000000,
    0.69140625000000000000000000000000, -0.11962890625000000000000000000000,
    0.50390625000000000000000000000000, -0.25976562500000000000000000000000,
    0.69140625000000000000000000000000, -0.11962890625000000000000000000000,
    0.86718750000000000000000000000000, -0.03076171875000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    0.86718750000000000000000000000000, -0.03076171875000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    0.86718750000000000000000000000000, 0.03076171875000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    0.86718750000000000000000000000000, 0.03076171875000000000000000000000,
    0.69140625000000000000000000000000, 0.11962890625000000000000000000000,
    0.50390625000000000000000000000000, 0.25976562500000000000000000000000,
    0.69140625000000000000000000000000, 0.11962890625000000000000000000000,
    0.50390625000000000000000000000000, 0.25976562500000000000000000000000,
    0.34765625000000000000000000000000, 0.41601562500000000000000000000000,
    0.22949218750000000000000000000000, 0.56250000000000000000000000000000,
    0.34765625000000000000000000000000, 0.41601562500000000000000000000000,
    0.22949218750000000000000000000000, 0.56250000000000000000000000000000,
    0.14550781250000000000000000000000, 0.68750000000000000000000000000000,
    0.09179687500000000000000000000000, 0.78125000000000000000000000000000,
    0.14550781250000000000000000000000, 0.68750000000000000000000000000000,
    0.09179687500000000000000000000000, 0.78125000000000000000000000000000,
    0.05639648437500000000000000000000, 0.85156250000000000000000000000000,
    0.03540039062500000000000000000000, 0.89843750000000000000000000000000,
    0.05639648437500000000000000000000, 0.85156250000000000000000000000000,
    0.03540039062500000000000000000000, 0.89843750000000000000000000000000,
    0.02124023437500000000000000000000, 0.93359375000000000000000000000000,
    0.01269531250000000000000000000000, 0.95703125000000000000000000000000,
    0.02124023437500000000000000000000, 0.93359375000000000000000000000000,
    0.01269531250000000000000000000000, 0.95703125000000000000000000000000,
    0.00750732421875000000000000000000, 0.97265625000000000000000000000000,
    0.00509643554687500000000000000000, 0.98046875000000000000000000000000,
    0.00750732421875000000000000000000, 0.97265625000000000000000000000000,
    0.00509643554687500000000000000000, 0.98046875000000000000000000000000,
    0.00283813476562500000000000000000, 0.98828125000000000000000000000000,
    0.00000000000000000000000000000000, 1.00000000000000000000000000000000,
    0.00283813476562500000000000000000, 0.98828125000000000000000000000000,
    0.00000000000000000000000000000000, 1.00000000000000000000000000000000,
};
